{"version":3,"sources":["webpack:///./src/views/Auth.vue","webpack:///./src/use/login-form.js","webpack:///./src/views/Auth.vue?59b5"],"names":["for","class","onSubmit","eError","type","id","email","eBlur","pError","password","pBlur","disabled","isSubmitting","isTooManyAttempts","useLoginForm","store","useStore","router","useRouter","useForm","handleSubmit","submitCount","useField","yup","trim","required","value","errorMessage","handleBlur","MIN_LENGTH","min","computed","watch","val","setTimeout","values","dispatch","push","setup","route","query","message","error","__exports__","render"],"mappings":"qNAEI,eAAwB,UAApB,mBAAe,G,EAGjB,eAAgC,SAAzBA,IAAI,SAAQ,SAAK,G,YAMxB,eAAsC,SAA/BA,IAAI,YAAW,YAAQ,G,mBAM3BC,MAAM,e,wEAhBb,eAmBO,QAnBDA,MAAM,OAAQ,SAAM,8CAAU,EAAAC,UAAA,EAAAA,SAAA,qBAAQ,e,CAC1C,EAEA,eAIM,OAJAD,MAAK,yBAA6B,EAAAE,U,CACtC,E,eACA,eAA6D,SAAtDC,KAAK,QAAQC,GAAG,Q,qDAAiB,EAAAC,MAAK,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAd,EAAAD,SAC3B,EAAAH,Q,iBAAb,eAAuC,yBAAhB,EAAAA,QAAM,I,0BAG/B,eAIM,OAJAF,MAAK,yBAA6B,EAAAO,U,CACtC,E,eACA,eAAsE,SAA/DJ,KAAK,WAAWC,GAAG,W,qDAAoB,EAAAI,SAAQ,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAjB,EAAAD,YACjC,EAAAD,Q,iBAAb,eAAuC,yBAAhB,EAAAA,QAAM,I,0BAG/B,eAAsG,UAA9FP,MAAM,cAAcG,KAAK,SAAUO,SAAU,EAAAC,cAAgB,EAAAC,mBAAmB,QAAK,gBAC9D,EAAAA,mB,iBAA/B,eAEwB,MAFxB,EAAkD,kE,sICX/C,SAASC,IAEZ,IAAMC,EAAQC,iBACRC,EAASC,iBAHW,EAIwBC,iBAA3CC,EAJmB,EAInBA,aAAcR,EAJK,EAILA,aAAcS,EAJT,EAISA,YAJT,EAMsCC,eAC5D,QACAC,SAAaC,OAAOC,SAAS,4BAA4BnB,MAAM,uCAFrDA,EANY,EAMnBoB,MAA4BvB,EANT,EAMLwB,aAAkCpB,EAN7B,EAMiBqB,WAKrCC,EAAa,EAXO,EAayCP,eAC/D,WACAC,SAAaC,OAAOC,SAAS,6BACxBK,IAAID,EADT,sCACoDA,EADpD,eAFUpB,EAbY,EAanBiB,MAA+BlB,EAbZ,EAaFmB,aAAkCjB,EAbhC,EAaoBkB,WAMxCf,EAAoBkB,gBAAS,kBAAMV,EAAYK,OAAS,KAE9DM,eAAMnB,GAAmB,SAAAoB,GAClBA,GACCC,YAAW,kBAAMb,EAAYK,MAAQ,IAAG,SAIhD,IAAMxB,EAAWkB,EAAY,yDAAC,WAAMe,GAAN,0GAGhBpB,EAAMqB,SAAS,aAAcD,GAHb,OAItBlB,EAAOoB,KAAK,KAJU,0GAAD,uDAW7B,MAAO,CACH/B,QACAG,WACAN,SACAK,SACAD,QACAG,QACAR,WACAU,eACAC,qB,gBDxBO,GACbyB,MADa,WAEX,IAAMC,EAAQ,iBACRxB,EAAQ,iBAOd,OANIwB,EAAMC,MAAMC,SACd1B,EAAMqB,SAAS,aAAc,CAC3BV,MAAO,OAAAgB,EAAA,MAAMH,EAAMC,MAAMC,SACzBrC,KAAM,YAGV,kBAAWU,O,qBElCf,MAAM6B,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAE1E","file":"js/chunk-2d0be70b.79b7d155.js","sourcesContent":["<template>\r\n  <form class=\"card\" @submit.prevent=\"onSubmit\">\r\n    <h1>Войти в систему</h1>\r\n\r\n    <div :class=\"['form-control', {invalid: eError}]\">\r\n      <label for=\"email\">Email</label>\r\n      <input type=\"email\" id=\"email\" v-model=\"email\" @blur=\"eBlur\">\r\n      <small v-if=\"eError\">{{eError}}</small>\r\n    </div>\r\n\r\n    <div :class=\"['form-control', {invalid: pError}]\">\r\n      <label for=\"password\">Password</label>\r\n      <input type=\"password\" id=\"password\" v-model=\"password\" @blur=\"pBlur\">\r\n      <small v-if=\"pError\">{{pError}}</small>\r\n    </div>\r\n\r\n    <button class=\"btn primary\" type=\"sumbit\" :disabled=\"isSubmitting || isTooManyAttempts\">Войти</button>\r\n    <div class=\"text-danger\" v-if=\"isTooManyAttempts\">\r\n      Вы слишком часто пытаетесь войти в систему.\r\n      Попробуйте позже</div>\r\n  </form>\r\n</template>\r\n\r\n<script>\r\nimport {useLoginForm} from \"@/use/login-form\";\r\nimport {useRoute} from 'vue-router'\r\nimport {useStore} from \"vuex\";\r\nimport {error} from \"../../utils/error\";\r\n\r\nexport default {\r\n  setup(){\r\n    const route = useRoute()\r\n    const store = useStore()\r\n    if (route.query.message){\r\n      store.dispatch('setMessage', {\r\n        value: error(route.query.message),\r\n        type: 'warning'\r\n      })\r\n    }\r\n    return {...useLoginForm()}\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import {useField, useForm} from \"vee-validate\";\r\nimport * as yup from \"yup\";\r\nimport {computed, watch} from \"vue\";\r\nimport {useStore} from 'vuex'\r\nimport {useRouter} from 'vue-router'\r\n\r\nexport function useLoginForm(){\r\n\r\n    const store = useStore()\r\n    const router = useRouter()\r\n    const {handleSubmit, isSubmitting, submitCount} = useForm()\r\n\r\n    const {value: email, errorMessage: eError, handleBlur: eBlur} = useField(\r\n        'email',\r\n        yup.string().trim().required('Пожалуйста введите email').email('Необходимо ввести корректный email')\r\n    )\r\n\r\n    const MIN_LENGTH = 6\r\n\r\n    const {value: password, errorMessage: pError, handleBlur: pBlur} = useField(\r\n        'password',\r\n        yup.string().trim().required('Пожалуйста введите пароль')\r\n            .min(MIN_LENGTH, `Пароль не может быть меньше ${MIN_LENGTH} символов`)\r\n    )\r\n\r\n    const isTooManyAttempts = computed(() => submitCount.value >= 3)\r\n\r\n    watch(isTooManyAttempts, val => {\r\n        if(val){\r\n            setTimeout(() => submitCount.value = 0, 1500)\r\n        }\r\n    })\r\n\r\n    const onSubmit = handleSubmit(async values => {\r\n      //  console.log('Form: ', values)\r\n        try {\r\n            await store.dispatch('auth/login', values)\r\n            router.push('/')\r\n        }catch (e){\r\n\r\n        }\r\n\r\n    })\r\n\r\n    return {\r\n        email,\r\n        password,\r\n        eError,\r\n        pError,\r\n        eBlur,\r\n        pBlur,\r\n        onSubmit,\r\n        isSubmitting,\r\n        isTooManyAttempts\r\n    }\r\n}","import { render } from \"./Auth.vue?vue&type=template&id=563492fb&scoped=true\"\nimport script from \"./Auth.vue?vue&type=script&lang=js\"\nexport * from \"./Auth.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\OpenServer\\\\domains\\\\localhost\\\\work\\\\Vue 3 2021 Владилен Минин\\\\014_1\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-563492fb\"]])\n\nexport default __exports__"],"sourceRoot":""}